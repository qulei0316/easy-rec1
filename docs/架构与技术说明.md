# 架构与技术说明

## 总体架构
- 多路召回+多级排序+重排融合
- 各模块解耦，便于扩展

## 技术选型
- 数据处理：Pandas/Numpy
- 召回：协同过滤/内容相似/热门/implicit+FAISS/双塔+FAISS
- 排序：Sklearn LR/LightGBM/Transformer 精排（DNN 旧版保留）
- 服务：Flask RESTful API
- 测试：requests/unittest

## implicit + FAISS 调参建议
- 向量维度 `factors`：16~64（数据小用16~32，数据大可提高）
- 训练轮次 `iterations`：5~20（过拟合风险增大时降低）
- 正则 `regularization`：0.01~0.1（过拟合时增大）
- FAISS索引类型：小数据用 `IndexFlatIP`，大数据可换为 `IVF` 或 `HNSW`
- 相似度：向量L2归一化后用内积≈余弦相似度
- TopK建议：召回阶段5~50，按业务量级调整

## 双塔 + FAISS 调参建议
- 向量维度 `emb_dim`：16~128（离线指标上升但在线成本提高）
- 负采样比例 `neg_ratio`：2~10（过低会偏正样本，过高影响训练速度）
- 训练轮次 `epochs`：5~20（小数据可用5~10）
- 损失函数：binary cross entropy（简单稳定），也可尝试softmax/InfoNCE
- TopK建议：召回阶段10~100（结合融合策略）

## Transformer 精排调参建议
- 维度 `emb_dim`：32~128（数据小用32~64）
- 注意力头数 `num_heads`：2~8（与维度匹配）
- 前馈层 `ff_dim`：64~256
- 序列长度 `SEQ_LEN`：10~50（短视频场景常用20~30）
- 层数：1~4（本项目默认1层，确保CPU可跑）
- 批大小：32~256（视内存与速度调整）

## 说明
- 所有模型均支持CPU运行
- 代码含中文注释，便于理解
