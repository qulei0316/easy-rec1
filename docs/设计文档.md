# 推荐系统设计文档

## 架构
- data/ 数据生成与样例
- features/ 特征工程
- recall/ 召回模块
- prerank/ 粗排模块
- rank/ 精排模块
- rerank/ 重排模块
- blend/ 策略融合
- service/ 后端API
- tests/ 测试脚本

## 数据流
1. 生成用户、视频、行为日志
2. 特征工程处理
3. 多路召回（含implicit+FAISS、双塔+FAISS向量召回）
4. 粗排过滤
5. 精排打分（序列 Transformer 精排，DNN 版本保留为旧版）
6. 重排与融合
7. API服务返回推荐结果

## 主要技术
- Python + Numpy/Pandas/Scikit-learn/LightGBM/Tensorflow/Flask
- 精排采用序列 Transformer（用户最近行为序列 + 注意力编码）
- 旧版 DNN 精排保留文件：rank/rank_main_dnn.py
- 纯CPU环境兼容

## implicit + FAISS 召回说明
- implicit(ALS) 负责训练用户与视频的隐式反馈向量，适合稀疏交互场景。
- FAISS 负责向量近邻检索，通过内积/余弦相似度快速获取TopK候选。
- 该模块与热门/协同过滤/内容召回并行产出候选，再进行去重融合。

## 双塔 + FAISS 召回说明
- 双塔分别建模用户与视频向量，通过点积表示相关性。
- 训练完成后，用FAISS对视频向量建索引，实现高效TopK召回。
- 与其他召回源并行输出，提高覆盖与相关性。
